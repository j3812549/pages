var Le=Object.defineProperty;var Te=(a,t,s)=>t in a?Le(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;var _=(a,t,s)=>(Te(a,typeof t!="symbol"?t+"":t,s),s),oe=(a,t,s)=>{if(!t.has(a))throw TypeError("Cannot "+s)};var e=(a,t,s)=>(oe(a,t,"read from private field"),s?s.call(a):t.get(a)),r=(a,t,s)=>{if(t.has(a))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(a):t.set(a,s)},c=(a,t,s,h)=>(oe(a,t,"write to private field"),h?h.call(a,s):t.set(a,s),s);var ue=(a,t,s,h)=>({set _(i){c(a,t,i,s)},get _(){return e(a,t,h)}}),l=(a,t,s)=>(oe(a,t,"access private method"),s);import{H as U}from"./hls.js-lXiquXni.js";import{_ as Se}from"./plugin-vueexport-helper-x3n3nnut.js";import{t as xe,f as Ce,e as be}from"./@vue-iHuVgEcH.js";let re=null;const ke=(a,t=500)=>{re&&clearTimeout(re),re=setTimeout(()=>{a()},t)},Fe=(a,t)=>{const s=document.createElement(a);return t&&t(s),s};var w,p,R,u,G,de;class _e{constructor(t={}){r(this,G);r(this,w,null);r(this,p,null);r(this,R,"");r(this,u,{error:()=>{},succee:()=>{},onProgress:()=>{},onPlaying:()=>{},onEnded:()=>{},onPause:()=>{},onPlay:()=>{}});var s,h,i,o,d,f,b,ce;c(this,p,t.el),c(this,R,t.url),e(this,u).error=(s=t.handle)==null?void 0:s.error,e(this,u).succee=(h=t.handle)==null?void 0:h.succee,e(this,u).onProgress=(i=t.handle)==null?void 0:i.onProgress,e(this,u).onEnded=(o=t.handle)==null?void 0:o.onEnded,e(this,u).onPause=(d=t.handle)==null?void 0:d.onPause,e(this,u).onPlay=(f=t.handle)==null?void 0:f.onPlay,e(this,u).onPlaying=(b=t.handle)==null?void 0:b.onPlaying,e(this,u).onCanplay=(ce=t.handle)==null?void 0:ce.onCanplay,l(this,G,de).call(this)}play(){return e(this,p).play()}pause(){return e(this,p).pause()}destroy(){e(this,w).destroy()}fullscreen(){e(this,p).requestFullscreen()}setCurrentTime(t){e(this,p).currentTime=t}onHandle(){const t=this;e(this,p).addEventListener("canplay",function(){console.log("===canplay"),e(t,u).onCanplay({video:this,duration:this.duration,currentTime:this.currentTime})}),e(this,p).addEventListener("playing",function(){console.log("===playing"),e(t,u).onPlaying({duration:this.duration,video:this})}),e(this,p).addEventListener("timeupdate",function(){e(t,u).onProgress({currentTime:this.currentTime,video:this})}),e(this,p).addEventListener("ended",function(){console.log("===ended"),e(t,u).onEnded({video:this})}),e(this,p).addEventListener("pause",function(){console.log("===pause"),e(t,u).onPause({video:this})}),e(this,p).addEventListener("play",function(){console.log("===play"),e(t,u).onPlay({video:this})})}}w=new WeakMap,p=new WeakMap,R=new WeakMap,u=new WeakMap,G=new WeakSet,de=function(){if(!U.isSupported())throw new Error("设备不支持hls播放方式");c(this,w,new U),e(this,w).loadSource(e(this,R)),e(this,w).attachMedia(e(this,p));const t=this;e(this,w).on(U.Events.MANIFEST_PARSED,()=>{e(t,u).succee&&e(t,u).succee({video:this}),t.onHandle()}),e(this,w).on(U.Events.ERROR,()=>{e(t,u).error&&e(t,u).error({video:this})})};const z=a=>{if(typeof a=="string")return a;const t=new Date(a*1e3),s=(d,f=2,b="0")=>d.toString().padStart(f,b),h=t.getUTCHours(),i=t.getUTCMinutes(),o=t.getSeconds();return h===0?`${s(i)}:${s(o)}`:`${s(h)}:${s(i)}:${s(o)}`};function Ae(){return!!window.navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)}var B,L,$,v,y,g,H,T,P,E,k,q,S,F,n,m,I,le,X,J,x,A,N,pe,V,ge,Y,fe,Z,ye,ee,me,te,Pe,W,ae,se,we,j,he,ne,ve,ie,Ee,C,M,D,K,O,Q;class Me{constructor(t={}){r(this,I);r(this,X);r(this,x);r(this,N);r(this,V);r(this,Y);r(this,Z);r(this,ee);r(this,te);r(this,W);r(this,se);r(this,j);r(this,ne);r(this,ie);r(this,C);r(this,D);r(this,O);_(this,"isFullscreen",!1);_(this,"isPlay",!1);_(this,"isLoading",!0);_(this,"isError",!1);_(this,"showContainer",!1);r(this,B,{});r(this,L,null);r(this,$,Ae());r(this,v,null);r(this,y,null);r(this,g,null);r(this,H,null);r(this,T,[]);r(this,P,0);r(this,E,!0);r(this,k,{start:0,end:0});r(this,q,!1);r(this,S,void 0);r(this,F,void 0);r(this,n,{warp:null,error:null,loading:null,fullscreen:null,loudness:null,toggle:null,process:{warp:null,length:null,backgroundLength:null,markLength:null,mark:null,duration:null,currentTime:null}});r(this,m,{onError:()=>{},onSuccee:()=>{},onProgress:()=>{},onPlaying:()=>{},onEnded:()=>{},onPause:()=>{},onPlay:()=>{},onCanplay:()=>{}});c(this,v,t.box||document.getElementById("tiancai9-video")),c(this,T,t.sources),c(this,q,t.autoPlay),c(this,m,{...e(this,m),...t.onHandle}),l(this,j,he).call(this),l(this,I,le).call(this)}openFullscreen(){if(this.isFullscreen=!0,e(this,$)){const h=window.innerHeight,i=window.innerWidth;e(this,y).style.width=h+"px",e(this,y).style.height=i+"px",e(this,v).classList.add("tiancai9-video-fullscreen")}else{const h=e(this,H);var t=h.requestFullScreen||h.webkitRequestFullScreen||h.mozRequestFullScreen||h.msRequestFullScreen,s;if(typeof t<"u"&&t){t.call(h);return}typeof window.ActiveXObject<"u"&&(s=new ActiveXObject("WScript.Shell"),s&&s.SendKeys("{F11}"))}}exitFullscreen(){if(this.isFullscreen=!1,e(this,$))e(this,y).style.width="",e(this,y).style.height="",e(this,v).classList.remove("tiancai9-video-fullscreen");else{var t=document,s=t.cancelFullScreen||t.webkitCancelFullScreen||t.mozCancelFullScreen||t.exitFullScreen,h;if(typeof s<"u"&&s){s.call(t);return}typeof window.ActiveXObject<"u"&&(h=new ActiveXObject("WScript.Shell"),h!=null&&h.SendKeys("{F11}"))}}destroy(){c(this,P,0),this.isError=!1,this.isLoading=!1,e(this,g).destroy(),e(this,v).innerHTML=""}play(){this.isPlay=!0,e(this,g).play()}pause(){this.isPlay=!1,e(this,g).pause()}reinit(){c(this,P,0),this.isError=!1,this.isLoading=!0,e(this,g).destroy(),l(this,j,he).call(this),l(this,I,le).call(this)}replay(){c(this,P,0),this.isError=!1,this.isLoading=!0,e(this,g).destroy(),l(this,X,J).call(this,e(this,T)[e(this,P)])}}B=new WeakMap,L=new WeakMap,$=new WeakMap,v=new WeakMap,y=new WeakMap,g=new WeakMap,H=new WeakMap,T=new WeakMap,P=new WeakMap,E=new WeakMap,k=new WeakMap,q=new WeakMap,S=new WeakMap,F=new WeakMap,n=new WeakMap,m=new WeakMap,I=new WeakSet,le=function(){const t=(s,h)=>{e(this,B)[s]=this[s],Object.defineProperty(this,s,{set(i){h(i),e(this,B)[s]=i},get(){return e(this,B)[s]}})};t("isPlay",s=>{s?(e(this,n).toggle.classList.add("pause-icon"),e(this,n).toggle.classList.remove("play-icon")):(e(this,n).toggle.classList.remove("pause-icon"),e(this,n).toggle.classList.add("play-icon"))}),t("isLoading",s=>{e(this,n).loading.style.display=s?"block":"none"}),t("isError",s=>{e(this,n).error.style.display=s?"block":"none"}),t("showContainer",s=>{e(this,n).warp.style.display=s?"block":"none",s?l(this,D,K).call(this):l(this,O,Q).call(this)})},X=new WeakSet,J=function(t){c(this,g,new _e({el:e(this,H),url:t,handle:{error:s=>l(this,se,we).call(this,s),succee:s=>l(this,W,ae).call(this,s),onPlaying:s=>l(this,te,Pe).call(this,s)&e(this,m).onPlaying(s),onProgress:s=>l(this,ee,me).call(this,s)&e(this,m).onProgress(s),onPlay:s=>l(this,Y,fe).call(this,s)&e(this,m).onPlay(s),onPause:s=>l(this,V,ge).call(this,s)&e(this,m).onPause(s),onEnded:s=>l(this,Z,ye).call(this,s)&e(this,m).onEnded(s),onCanplay:s=>l(this,N,pe).call(this,s)&e(this,m).onCanplay(s)&l(this,W,ae).call(this,s)}})),e(this,g).setCurrentTime(e(this,F)||0)},x=new WeakSet,A=function(){return!this.isLoading},N=new WeakSet,pe=function({duration:t,currentTime:s}){e(this,q)&&(e(this,g).play(),this.isPlay=!0,e(this,n).toggle.classList.add("pause-icon")),this.isLoading=!1,this.showContainer=!0,c(this,F,s),c(this,S,t),e(this,n).process.duration.innerText=z(e(this,S)),e(this,n).process.currentTime.innerText=z(s)},V=new WeakSet,ge=function(){this.isPlay=!1},Y=new WeakSet,fe=function(){this.isPlay=!0},Z=new WeakSet,ye=function(){},ee=new WeakSet,me=function({currentTime:t}){l(this,x,A).call(this)&&e(this,E)&&(c(this,F,t),e(this,n).process.currentTime.innerText=z(t),e(this,n).process.duration.innerText=z(e(this,S)),e(this,n).process.markLength.style.width=`${e(this,F)*100/e(this,S)}%`)},te=new WeakSet,Pe=function({duration:t}){},W=new WeakSet,ae=function(){},se=new WeakSet,we=function(){if(e(this,P)>=e(this,T).length-1){this.isError=!0,this.isLoading=!1,e(this,m).onError();return}e(this,g).destroy(),ue(this,P)._++,l(this,X,J).call(this,e(this,T)[e(this,P)])},j=new WeakSet,he=function(){l(this,ne,ve).call(this),l(this,X,J).call(this,e(this,T)[e(this,P)]),l(this,ie,Ee).call(this)},ne=new WeakSet,ve=function(){const t=(s,h="div",i=e(this,y))=>Fe(h,o=>(Array.isArray(s)?s.forEach(d=>o.classList.add(d)):o.classList.add(s),i.append(o),o));c(this,y,t("tiancai9-video-warp","div",e(this,v))),e(this,v).classList.add("tiancai9-video-box"),c(this,H,t("tiancai9-video-main","video")),e(this,n).warp=t("container","div",e(this,y)),e(this,n).fullscreen=t(["fullscreen","btn","fullscreen-icon"],"div",e(this,n).warp),e(this,n).toggle=t(["toggle","btn","play-icon"],"div",e(this,n).warp),e(this,n).loading=t("loading","div",e(this,y)),t("loading-icon","div",e(this,n).loading),e(this,n).error=t("error","div",e(this,y)),t("error-icon","div",e(this,n).error),e(this,n).process.warp=t("process","div",e(this,n).warp),e(this,n).process.length=t("length","div",e(this,n).process.warp),e(this,n).process.markLength=t("markLength","div",e(this,n).process.length),e(this,n).process.backgroundLength=t("backgroundLength","div",e(this,n).process.length),e(this,n).process.mark=t("mark","div",e(this,n).process.length),e(this,n).process.currentTime=t("currentTime","div",e(this,n).process.warp),t("secondary","div",e(this,n).process.warp).innerText="/",e(this,n).process.duration=t("duration","div",e(this,n).process.warp),e(this,n).process.currentTime.innerText="00",e(this,n).process.duration.innerText="00"},ie=new WeakSet,Ee=function(){const t=this;e(this,n).error.onclick=function(i){t.replay(),i.stopPropagation()},e(this,y).onclick=function(i){var o;l(o=t,x,A).call(o)&&t.showContainer===!1&&(t.showContainer=!0,i.stopPropagation())},e(this,n).warp.onclick=function(i){var o;l(o=t,x,A).call(o)&&t.showContainer===!0&&(t.showContainer=!1,i.stopPropagation())},e(this,n).toggle.onclick=function(i){var o;l(o=t,x,A).call(o)&&(t.isPlay?e(t,g).pause():e(t,g).play(),t.isPlay=!t.isPlay,i.stopPropagation())},e(this,n).fullscreen.onclick=function(i){var o;l(o=t,x,A).call(o)&&(t.isFullscreen===!1?t.openFullscreen():t.exitFullscreen(),i.stopPropagation())},e(this,n).process.length.onclick=function(i){i.stopPropagation()&&i.preventDefault()},e(this,n).process.length.onmousedown=function(i){var d,f;c(t,E,!1);const o=i.layerX;console.log("=========onmousedown"),e(t,k).start=o,e(t,k).end=o,l(d=t,C,M).call(d,o),l(f=t,O,Q).call(f),i.stopPropagation()&&i.preventDefault()},e(this,n).process.length.onmousemove=function(i){var d;if(e(t,E))return;const o=i.layerX;e(t,k).end=o,l(d=t,C,M).call(d,o),i.stopPropagation()&&i.preventDefault()},e(this,n).process.length.onmouseup=function(i){var d,f;console.log("=========onmouseup"),c(t,E,!0);const o=e(t,k).end;l(d=t,C,M).call(d,o,!0),l(f=t,D,K).call(f),i.stopPropagation()&&i.preventDefault()};let s=null,h=null;e(this,n).process.length.addEventListener("touchstart",function(i){var o;console.log("touchstart"),c(t,E,!1),l(o=t,O,Q).call(o),s=i.changedTouches[0].clientX,h=i.changedTouches[0].clientX-e(t,n).process.warp.offsetLeft},!1),e(this,n).process.length.addEventListener("touchend",function(i){var o;console.log("touchend"),l(o=t,C,M).call(o,h,!0),c(t,E,!0)},!1),e(this,n).process.length.addEventListener("touchmove",function(i){var f,b;console.log("touchmove");const o=i.changedTouches[0].clientX,d=o-s-e(t,n).process.warp.offsetLeft;s=o,h=o+d,l(f=t,C,M).call(f,h),l(b=t,D,K).call(b)},!1)},C=new WeakSet,M=function(t,s=!1){const h=e(this,n).process.backgroundLength.clientWidth,o=t/h*e(this,S);e(this,n).process.markLength.style.width=t>=h?h:t+"px",s&&(this.isLoading=!0,ke(()=>{e(this,g).setCurrentTime(o)},200))},D=new WeakSet,K=function(){e(this,L)&&clearTimeout(e(this,L)),c(this,L,setTimeout(()=>{this.showContainer=!1},1e4))},O=new WeakSet,Q=function(){e(this,L)&&clearTimeout(e(this,L))};const Be={id:"tiancai9-video"},He={__name:"index",setup(a){return xe(()=>{new Me({autoPlay:!0,onHandle:{onError:()=>{console.log("onError")},onSuccee:()=>{console.log("onSuccee")},onProgress:()=>{console.log("onProgress")},onPlaying:()=>{console.log("onPlaying")},onEnded:()=>{console.log("onEnded")},onPause:()=>{console.log("onPause")},onPlay:()=>{console.log("onPlay")},onCanplay:()=>{console.log("onCanplay")}},box:document.getElementById("tiancai9-video"),sources:["http://127.0.0.1:3000/1.mp4","https://c3.monidai.com/20231119/JqT4DANw/index.m3u8","https://c3.monid43ai.com/202","https://c354.mon424idai.com/202"]})}),(t,s)=>(be(),Ce("div",Be))}},$e=Se(He,[["__scopeId","data-v-3e70c3d4"]]);export{$e as default};
